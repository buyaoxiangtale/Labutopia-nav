# æœºå™¨äººåˆå§‹åŒ–ä»£ç è¯¦è§£

## ğŸ“‹ ä»£ç åˆ†æ

### é€‰ä¸­çš„ä»£ç æ®µï¼ˆç¬¬ 69-90 è¡Œï¼‰

```python
world = World(stage_units_in_meters=1.0, physics_prim_path="/physicsScene")

robot_path = "/World/Ridgebase"
add_reference_to_stage(
    usd_path="assets/robots/ridgeback_franka.usd",
    prim_path=robot_path
)

from omni.isaac.core.robots import Robot
robot = Robot(
    prim_path=robot_path,
    name="ridgebase",
    position=np.array([0.0, 0.0, 0.0])
)

controller = RidgebaseController(
    robot_articulation=robot,
    max_linear_speed=0.02,
    max_angular_speed=1.5,
    position_threshold=0.08,
    angle_threshold=0.1
)
```

---

## ğŸ” é€è¡Œè¯¦ç»†è¯´æ˜

### 1. åˆ›å»ºç‰©ç†ä¸–ç•Œ

```python
world = World(stage_units_in_meters=1.0, physics_prim_path="/physicsScene")
```

**ä½œç”¨**ï¼šåˆ›å»º Isaac Sim çš„ç‰©ç†ä»¿çœŸä¸–ç•Œ

**å‚æ•°è¯´æ˜**ï¼š
- `stage_units_in_meters=1.0`ï¼š
  - è®¾ç½® USD stage çš„å•ä½ä¸ºç±³
  - `1.0` è¡¨ç¤º 1 ä¸ª USD å•ä½ = 1 ç±³
  - è¿™æ˜¯æ ‡å‡†è®¾ç½®ï¼Œç¡®ä¿å•ä½ä¸€è‡´

- `physics_prim_path="/physicsScene"`ï¼š
  - æŒ‡å®šç‰©ç†åœºæ™¯çš„ prim è·¯å¾„
  - ç‰©ç†å¼•æ“ä¼šåœ¨è¿™ä¸ªè·¯å¾„ä¸‹åˆ›å»ºç‰©ç†åœºæ™¯
  - ç”¨äºå¤„ç†ç¢°æ’ã€é‡åŠ›ç­‰ç‰©ç†æ•ˆæœ

**ç¤ºä¾‹**ï¼š
```python
# ä¸åŒå•ä½è®¾ç½®
world = World(stage_units_in_meters=0.01)  # 1 USD å•ä½ = 0.01 ç±³ï¼ˆå˜ç±³ï¼‰
world = World(stage_units_in_meters=100.0) # 1 USD å•ä½ = 100 ç±³
```

---

### 2. å®šä¹‰æœºå™¨äººè·¯å¾„

```python
robot_path = "/World/Ridgebase"
```

**ä½œç”¨**ï¼šå®šä¹‰æœºå™¨äººåœ¨åœºæ™¯ä¸­çš„ prim è·¯å¾„

**è¯´æ˜**ï¼š
- `"/World/Ridgebase"` æ˜¯æœºå™¨äººåœ¨ USD åœºæ™¯å›¾ä¸­çš„è·¯å¾„
- è¿™ä¸ªè·¯å¾„å¿…é¡»ä¸ USD æ–‡ä»¶ä¸­çš„å®é™…è·¯å¾„åŒ¹é…
- ç”¨äºåç»­åŠ è½½å’Œå¼•ç”¨æœºå™¨äºº

**å¦‚ä½•æŸ¥çœ‹å®é™…è·¯å¾„ï¼Ÿ**
1. åœ¨ Isaac Sim ä¸­æ‰“å¼€ USD æ–‡ä»¶
2. æŸ¥çœ‹ Outlinerï¼ˆå¤§çº²è§†å›¾ï¼‰
3. æ‰¾åˆ°æœºå™¨äººçš„æ ¹èŠ‚ç‚¹è·¯å¾„

---

### 3. åŠ è½½æœºå™¨äºº USD æ–‡ä»¶

```python
add_reference_to_stage(
    usd_path="assets/robots/ridgeback_franka.usd",
    prim_path=robot_path
)
```

**ä½œç”¨**ï¼šå°†æœºå™¨äºº USD æ–‡ä»¶åŠ è½½åˆ°åœºæ™¯ä¸­

**å‚æ•°è¯´æ˜**ï¼š
- `usd_path`ï¼šUSD æ–‡ä»¶çš„è·¯å¾„ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰
- `prim_path`ï¼šæœºå™¨äººåŠ è½½ååœ¨åœºæ™¯ä¸­çš„è·¯å¾„

**å·¥ä½œåŸç†**ï¼š
- è¯»å– USD æ–‡ä»¶
- å°†æœºå™¨äººçš„æ‰€æœ‰ primï¼ˆå‡ ä½•ä½“ã€å…³èŠ‚ã€æè´¨ç­‰ï¼‰æ·»åŠ åˆ°åœºæ™¯
- æœºå™¨äººä¼šå‡ºç°åœ¨æŒ‡å®šçš„ prim_path ä½ç½®

**ä½¿ç”¨ç»å¯¹è·¯å¾„**ï¼š
```python
add_reference_to_stage(
    usd_path=os.path.abspath("assets/robots/ridgeback_franka.usd"),
    prim_path=robot_path
)
```

---

### 4. åˆ›å»ºæœºå™¨äººå¯¹è±¡

```python
from omni.isaac.core.robots import Robot
robot = Robot(
    prim_path=robot_path,
    name="ridgebase",
    position=np.array([0.0, 0.0, 0.0])
)
```

**ä½œç”¨**ï¼šåˆ›å»º Robot å¯¹è±¡ï¼Œç”¨äºæ§åˆ¶å’Œæ“ä½œæœºå™¨äºº

**å‚æ•°è¯´æ˜**ï¼š
- `prim_path`ï¼šæœºå™¨äººåœ¨åœºæ™¯ä¸­çš„è·¯å¾„ï¼ˆå¿…é¡»ä¸åŠ è½½æ—¶ä¸€è‡´ï¼‰
- `name`ï¼šæœºå™¨äººçš„åç§°æ ‡è¯†ï¼ˆç”¨äºæ—¥å¿—å’Œè°ƒè¯•ï¼‰
- `position`ï¼šæœºå™¨äººçš„åˆå§‹ä½ç½® `[x, y, z]`ï¼ˆå•ä½ï¼šç±³ï¼‰

**åˆå§‹ä½ç½®è¯´æ˜**ï¼š
```python
position=np.array([0.0, 0.0, 0.0])
#                    â†‘    â†‘    â†‘
#                   Xè½´  Yè½´  Zè½´
```

**ä¿®æ”¹åˆå§‹ä½ç½®ç¤ºä¾‹**ï¼š
```python
# æ”¾ç½®åœ¨ X=2 ç±³ï¼ŒY=3 ç±³ï¼ŒZ=0.5 ç±³ï¼ˆåœ°é¢ä»¥ä¸Š 0.5 ç±³ï¼‰
position=np.array([2.0, 3.0, 0.5])

# æˆ–è€…è®¾ç½®åˆå§‹æœå‘ï¼ˆéœ€è¦é¢å¤–å‚æ•°ï¼‰
robot = Robot(
    prim_path=robot_path,
    name="ridgebase",
    position=np.array([0.0, 0.0, 0.0]),
    orientation=np.array([0.0, 0.0, 0.0, 1.0])  # å››å…ƒæ•°
)
```

---

### 5. åˆ›å»ºæ§åˆ¶å™¨

```python
controller = RidgebaseController(
    robot_articulation=robot,
    max_linear_speed=0.02,
    max_angular_speed=1.5,
    position_threshold=0.08,
    angle_threshold=0.1
)
```

**ä½œç”¨**ï¼šåˆ›å»ºæœºå™¨äººæ§åˆ¶å™¨ï¼Œç”¨äºè·¯å¾„è·Ÿè¸ªå’Œè¿åŠ¨æ§åˆ¶

**å‚æ•°è¯´æ˜**ï¼š

#### `robot_articulation=robot`
- ä¼ å…¥æœºå™¨äººå¯¹è±¡
- æ§åˆ¶å™¨é€šè¿‡å®ƒè®¿é—®æœºå™¨äººçš„å…³èŠ‚å’ŒçŠ¶æ€

#### `max_linear_speed=0.02` (ç±³/ç§’)
- **æœ€å¤§çº¿é€Ÿåº¦**ï¼šæœºå™¨äººç§»åŠ¨çš„æœ€å¤§é€Ÿåº¦
- `0.02` = 2 å˜ç±³/ç§’ï¼ˆå¾ˆæ…¢ï¼Œé€‚åˆç²¾ç¡®æ§åˆ¶ï¼‰
- **è°ƒæ•´å»ºè®®**ï¼š
  - æ…¢é€Ÿç²¾ç¡®ï¼š`0.01` (1 å˜ç±³/ç§’)
  - ä¸­ç­‰é€Ÿåº¦ï¼š`0.05` (5 å˜ç±³/ç§’)
  - å¿«é€Ÿç§»åŠ¨ï¼š`0.1` (10 å˜ç±³/ç§’) - å¯èƒ½ä¸å¤Ÿå¹³æ»‘

#### `max_angular_speed=1.5` (å¼§åº¦/ç§’)
- **æœ€å¤§è§’é€Ÿåº¦**ï¼šæœºå™¨äººæ—‹è½¬çš„æœ€å¤§é€Ÿåº¦
- `1.5` â‰ˆ 86 åº¦/ç§’
- **è°ƒæ•´å»ºè®®**ï¼š
  - æ…¢é€Ÿè½¬å‘ï¼š`0.5` (çº¦ 29 åº¦/ç§’)
  - å¿«é€Ÿè½¬å‘ï¼š`2.0` (çº¦ 115 åº¦/ç§’)

#### `position_threshold=0.08` (ç±³)
- **ä½ç½®åˆ°è¾¾é˜ˆå€¼**ï¼šè®¤ä¸ºåˆ°è¾¾èˆªç‚¹çš„è·ç¦»
- `0.08` = 8 å˜ç±³
- å¦‚æœè·ç¦»ç›®æ ‡ < 8 å˜ç±³ï¼Œè®¤ä¸ºå·²åˆ°è¾¾ï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªèˆªç‚¹
- **è°ƒæ•´å»ºè®®**ï¼š
  - ç²¾ç¡®æ¨¡å¼ï¼š`0.05` (5 å˜ç±³)
  - å®½æ¾æ¨¡å¼ï¼š`0.15` (15 å˜ç±³)

#### `angle_threshold=0.1` (å¼§åº¦)
- **è§’åº¦åˆ°è¾¾é˜ˆå€¼**ï¼šè®¤ä¸ºå®Œæˆè½¬å‘çš„è§’åº¦è¯¯å·®
- `0.1` â‰ˆ 5.7 åº¦
- å¦‚æœè§’åº¦è¯¯å·® < 0.1 å¼§åº¦ï¼Œè®¤ä¸ºå·²åˆ°è¾¾ç›®æ ‡è§’åº¦
- **è°ƒæ•´å»ºè®®**ï¼š
  - ç²¾ç¡®æ¨¡å¼ï¼š`0.05` (çº¦ 2.9 åº¦)
  - å®½æ¾æ¨¡å¼ï¼š`0.2` (çº¦ 11.5 åº¦)

---

## ğŸ¯ å®Œæ•´åˆå§‹åŒ–æµç¨‹

```
1. åˆ›å»ºç‰©ç†ä¸–ç•Œ (World)
   â†“
2. å®šä¹‰æœºå™¨äººè·¯å¾„ ("/World/Ridgebase")
   â†“
3. åŠ è½½æœºå™¨äºº USD æ–‡ä»¶åˆ°åœºæ™¯
   â†“
4. åˆ›å»º Robot å¯¹è±¡ï¼ˆç”¨äºæ§åˆ¶ï¼‰
   â†“
5. åˆ›å»º Controller å¯¹è±¡ï¼ˆç”¨äºè·¯å¾„è·Ÿè¸ªï¼‰
   â†“
6. å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥å¼€å§‹å¯¼èˆª
```

---

## ğŸ”§ å‚æ•°è°ƒæ•´å»ºè®®

### åœºæ™¯ 1ï¼šå¿«é€Ÿå¯¼èˆªï¼ˆä¸è¿½æ±‚ç²¾ç¡®ï¼‰

```python
controller = RidgebaseController(
    robot_articulation=robot,
    max_linear_speed=0.05,      # å¢åŠ åˆ° 5 å˜ç±³/ç§’
    max_angular_speed=2.0,      # å¢åŠ åˆ° 115 åº¦/ç§’
    position_threshold=0.15,    # å¢åŠ åˆ° 15 å˜ç±³
    angle_threshold=0.15        # å¢åŠ åˆ°çº¦ 8.6 åº¦
)
```

### åœºæ™¯ 2ï¼šç²¾ç¡®å¯¼èˆªï¼ˆæ…¢é€Ÿä½†ç²¾ç¡®ï¼‰

```python
controller = RidgebaseController(
    robot_articulation=robot,
    max_linear_speed=0.01,      # é™ä½åˆ° 1 å˜ç±³/ç§’
    max_angular_speed=0.5,      # é™ä½åˆ°çº¦ 29 åº¦/ç§’
    position_threshold=0.05,    # é™ä½åˆ° 5 å˜ç±³
    angle_threshold=0.05        # é™ä½åˆ°çº¦ 2.9 åº¦
)
```

### åœºæ™¯ 3ï¼šå¹³è¡¡æ¨¡å¼ï¼ˆå½“å‰è®¾ç½®ï¼‰

```python
controller = RidgebaseController(
    robot_articulation=robot,
    max_linear_speed=0.02,      # 2 å˜ç±³/ç§’
    max_angular_speed=1.5,      # 86 åº¦/ç§’
    position_threshold=0.08,    # 8 å˜ç±³
    angle_threshold=0.1         # çº¦ 5.7 åº¦
)
```

---

## ğŸ’¡ å¸¸è§ä¿®æ”¹ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šä¿®æ”¹æœºå™¨äººåˆå§‹ä½ç½®

```python
robot = Robot(
    prim_path=robot_path,
    name="ridgebase",
    position=np.array([2.0, 3.0, 0.0])  # ç§»åŠ¨åˆ° (2, 3, 0)
)
```

### ç¤ºä¾‹ 2ï¼šæ›´æ¢æœºå™¨äººæ¨¡å‹

```python
robot_path = "/World/MyRobot"  # æ›´æ–°è·¯å¾„
add_reference_to_stage(
    usd_path="assets/robots/my_new_robot.usd",  # æ–°æœºå™¨äººæ–‡ä»¶
    prim_path=robot_path
)
robot = Robot(
    prim_path=robot_path,
    name="my_robot",  # æ›´æ–°åç§°
    position=np.array([0.0, 0.0, 0.0])
)
```

### ç¤ºä¾‹ 3ï¼šä½¿ç”¨é…ç½®å˜é‡

```python
# åœ¨æ–‡ä»¶é¡¶éƒ¨å®šä¹‰é…ç½®
ROBOT_CONFIG = {
    "usd_path": "assets/robots/ridgeback_franka.usd",
    "prim_path": "/World/Ridgebase",
    "name": "ridgebase",
    "initial_position": [0.0, 0.0, 0.0],
    "max_linear_speed": 0.02,
    "max_angular_speed": 1.5,
    "position_threshold": 0.08,
    "angle_threshold": 0.1
}

# ä½¿ç”¨é…ç½®
robot_path = ROBOT_CONFIG["prim_path"]
add_reference_to_stage(
    usd_path=ROBOT_CONFIG["usd_path"],
    prim_path=robot_path
)

robot = Robot(
    prim_path=robot_path,
    name=ROBOT_CONFIG["name"],
    position=np.array(ROBOT_CONFIG["initial_position"])
)

controller = RidgebaseController(
    robot_articulation=robot,
    max_linear_speed=ROBOT_CONFIG["max_linear_speed"],
    max_angular_speed=ROBOT_CONFIG["max_angular_speed"],
    position_threshold=ROBOT_CONFIG["position_threshold"],
    angle_threshold=ROBOT_CONFIG["angle_threshold"]
)
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. è·¯å¾„ä¸€è‡´æ€§

ç¡®ä¿æ‰€æœ‰åœ°æ–¹ä½¿ç”¨çš„è·¯å¾„ä¸€è‡´ï¼š
```python
robot_path = "/World/Ridgebase"  # å®šä¹‰è·¯å¾„
# ... åŠ è½½æ—¶ä½¿ç”¨ç›¸åŒè·¯å¾„
add_reference_to_stage(..., prim_path=robot_path)
# ... Robot å¯¹è±¡ä½¿ç”¨ç›¸åŒè·¯å¾„
Robot(prim_path=robot_path, ...)
```

### 2. å•ä½ä¸€è‡´æ€§

- `position` ä½¿ç”¨ç±³ä¸ºå•ä½
- `max_linear_speed` ä½¿ç”¨ç±³/ç§’
- `max_angular_speed` ä½¿ç”¨å¼§åº¦/ç§’

### 3. åˆå§‹åŒ–é¡ºåº

å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œï¼š
1. å…ˆåˆ›å»º World
2. å†åŠ è½½ USD æ–‡ä»¶
3. ç„¶ååˆ›å»º Robot å¯¹è±¡
4. æœ€ååˆ›å»º Controller

### 4. åˆå§‹ä½ç½®

- Z åæ ‡ï¼ˆé«˜åº¦ï¼‰å¯èƒ½éœ€è¦è°ƒæ•´ï¼Œå–å†³äºåœºæ™¯çš„åœ°é¢é«˜åº¦
- å¦‚æœæœºå™¨äºº"æ‰åˆ°åœ°ä¸‹äº†"ï¼Œå¢åŠ  Z å€¼
- å¦‚æœæœºå™¨äºº"æµ®åœ¨ç©ºä¸­"ï¼Œå‡å°‘ Z å€¼

---

## ğŸ“š ç›¸å…³ä»£ç ä½ç½®

- **æ§åˆ¶å™¨å®šä¹‰**ï¼š`controllers/robot_controllers/ridgebase/ridgebase_controller.py`
- **æœºå™¨äººåŠ è½½**ï¼šå¤šä¸ª demo æ–‡ä»¶
- **World åˆå§‹åŒ–**ï¼šIsaac Sim æ ¸å¿ƒåŠŸèƒ½

---

å¸Œæœ›è¿™ä¸ªè¯¦è§£èƒ½å¸®åŠ©ä½ ç†è§£å’Œä½¿ç”¨è¿™æ®µä»£ç ï¼ğŸ‰

